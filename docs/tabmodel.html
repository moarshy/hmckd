---

title: Building N_Point Model


keywords: fastai
sidebar: home_sidebar

summary: "In this notebook, we will build different TabularModels to tackle the task"
description: "In this notebook, we will build different TabularModels to tackle the task"
nb_path: "nbs/01_tabmodel.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_tabmodel.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Three-Point-TabularModel">Three-Point TabularModel<a class="anchor-link" href="#Three-Point-TabularModel"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(-10.0, 750.0)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlwAAAI/CAYAAACifAdEAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3dfZBldX3n8c93GQRUllEZkMAYpnB0UCsCTiHG+ICsBCYpobZcVySRpagdrbhZ3SSbNdmtMtlys3HV+BB2CVQwwdWgxIeCUspIDUjKVPkwKCLKIIMGBhaYQR7kSSLmt3/0GWigme6e6d+93X1fr6quPvd37u35/Youffc5595TrbUAANDPvxj3BAAAljvBBQDQmeACAOhMcAEAdCa4AAA6E1wAAJ2tGPcEkuTAAw9shx9++LinAQAwq6uuuurO1tqq+bxmUQTX4Ycfns2bN497GgAAs6qqm+b7GqcUAQA6E1wAAJ0JLgCAzgQXAEBnggsAoDPBBQDQmeACAOhMcAEAdCa4AAA6E1wAAJ0JLgCAzgQXAEBnggsAoDPBBQDQmeACAOhMcAEAdCa4AAA6E1wAAJ0JLgCAzgQXAEBnggsAoDPBBQDQmeACAOhMcAEAdCa4AAA6E1wAAJ0JLgCAzgQXAEBnggsAoDPBBQDQ2azBVVUvrKqrp339pKreVVXPrqrLquqG4fuzhudXVX20qrZW1TVVdUz/ZQAALF6zBldr7frW2lGttaOSvCzJg0k+n+TdSTa11tYm2TQ8TpKTk6wdvjYmOafHxAEAlor5nlI8IcmNrbWbkpyS5IJh/IIkpw7bpyT5eJvytSQrq+qQBZktAMASNN/genOSC4ftg1trtw3btyc5eNg+NMm2aa+5ZRgDAJhIcw6uqnpakjck+dsn7muttSRtPv9wVW2sqs1VtXnHjh3zeSkAwJIynyNcJyf5VmvtjuHxHTtPFQ7ftw/jtyZZPe11hw1jj9NaO6+1tr61tn7VqlXznzkAwBIxn+A6LY+dTkySS5KcMWyfkeTiaeNvHd6teFySe6edegQAmDgr5vKkqnpGktcnedu04T9NclFVnZXkpiRvGsYvTbIhydZMvaPxzAWbLQDAEjSn4GqtPZDkOU8Y+3Gm3rX4xOe2JO9YkNkBACwDPmkeAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdzSm4qmplVX2mqrZU1XVV9YqqenZVXVZVNwzfnzU8t6rqo1W1taquqapj+i4BAGBxm+sRro8k+VJrbV2Slya5Lsm7k2xqra1Nsml4nCQnJ1k7fG1Mcs6CzhgAYImZNbiq6oAkr05yfpK01v6ptXZPklOSXDA87YIkpw7bpyT5eJvytSQrq+qQBZ85AMASMZcjXGuS7EjyV1X17ar6y6p6RpKDW2u3Dc+5PcnBw/ahSbZNe/0twxgAwESaS3CtSHJMknNaa0cneSCPnT5MkrTWWpI2n3+4qjZW1eaq2rxjx475vBQAYEmZS3DdkuSW1trXh8efyVSA3bHzVOHwffuw/9Ykq6e9/rBh7HFaa+e11ta31tavWrVqd+cPALDozRpcrbXbk2yrqhcOQyck+X6SS5KcMYydkeTiYfuSJG8d3q14XJJ7p516BACYOCvm+LzfTvLJqnpakh8mOTNTsXZRVZ2V5KYkbxqee2mSDUm2JnlweC4AwMSaU3C11q5Osn6GXSfM8NyW5B17OC8AgGXDJ80DAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0Nmcgquq/rGqvltVV1fV5mHs2VV1WVXdMHx/1jBeVfXRqtpaVddU1TE9FwAAsNjN5wjX8a21o1pr64fH706yqbW2Nsmm4XGSnJxk7fC1Mck5CzVZAIClaE9OKZ6S5IJh+4Ikp04b/3ib8rUkK6vqkD34dwAAlrS5BldL8uWquqqqNg5jB7fWbhu2b09y8LB9aJJt0157yzAGADCRVszxeb/SWru1qg5KcllVbZm+s7XWqqrN5x8ewm1jkjzvec+bz0sBAJaUOR3haq3dOnzfnuTzSY5NcsfOU4XD9+3D029Nsnrayw8bxp74M89rra1vra1ftWrV7q8AAGCRmzW4quoZVbX/zu0kJya5NsklSc4YnnZGkouH7UuSvHV4t+JxSe6dduoRAGDizOWU4sFJPl9VO5//N621L1XVN5NcVFVnJbkpyZuG51+aZEOSrUkeTHLmgs8aAGAJmTW4Wms/TPLSGcZ/nOSEGcZbkncsyOwAAJYBnzQPANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFAHvg3O+cm1d96lU59zvnjnsqLGKLIriuv+t6v6gALDl3PnRnzr767Nzz8D05++qzc+dDd457SixSiyK4HmmP+EUFYMnYdPOmbPjchhx/0fGPGz/+ouOz4XMbcvnNl49pZixWiyK4dvKLCiwHTjEtfx+79mPZdt+2Gfdtu29bzr/2/BHPiMVuUQVX4hcVWNqcYpoMG9Zs2KP9TJ5FF1yJX1Rg6XGKabKcfuTpOW3daTPue8u6t+T0I08f8YxY7BZdcPlFBZYip5gmz10/vWte40y2OQdXVe1VVd+uqi8Mj9dU1deramtVfbqqnjaM7zM83jrsP3w+E/KLCixFTjFNnlX7rXp0e80Bax7dPnC/A8cxHRa5FfN47juTXJfkXw6P35fkQ621T1XVXyQ5K8k5w/e7W2vPr6o3D8/7t7v6wfvstc+j235RgaXo9CNPz00/uSkXbrnwSfscuV+e3vWyd+Xog47OESuPyBErj8iN99yYG++5Ma9Z/ZpxT41FaE7BVVWHJfm1JP8jye9UVSV5XZK3DE+5IMkfZSq4Thm2k+QzSc6uqmqttaf6+c9f+fx8+pRP+0UFljSnmCbLPnvtkxMPP/HRxzvDC2Yy1yNcH07y+0n2Hx4/J8k9rbVHhse3JDl02D40ybYkaa09UlX3Ds9/yrfqXH/99Tnr1LOSJH+SP5nP/AEWjZvvuzl3PHBHkmS/FfvloUceSpJ89hmfzTf3/+Y4pwaM2azBVVW/nmR7a+2qqnrtQv3DVbUxycYk2WeffWZ5NsDid9gzD8v+e++ffVfs+2hw/fSRn+aAfQ4Y99SAMZvLEa5XJnlDVW1Ism+mruH6SJKVVbViOMp1WJJbh+ffmmR1kluqakWSA5L8+Ik/tLV2XpLzkmT9+vXtK1/5yh4uZWk59zvn5hPXfSK/ceRv5G0vfdu4pwMAzNHUlVXzM+u7FFtrf9BaO6y1dniSNye5vLV2epIrkrxxeNoZSS4eti8ZHmfYf/murt+aRD4YEQAmy558Dtd/ydQF9FszdY3Wzg+ZOT/Jc4bx30ny7j2b4vLhgxGB5cwtjeCp1WI4+LR+/fq2efPmcU+ju9MvPT3X7LjmKff/0qpfyic3fHKEMwJYGHc+dOfj/pi84k1X+Jgflq2quqq1tn4+r1l0nzS/nPlgRGC5ceQe5kZwjZB7bznlAMuNWxrB3AiuEZvkD0ac5DcLCE2WK0fuYW4E14hN4r23Jv2UwySHJsufI/cwN/O5lyILYBLvvTWXUw6ve97rRjyr/jbdvCkf3PzBJ639+IuOz+r9V+f31v/eslw3k2eSj9zDXDnCNWI77721835bR6w8IicefuLjbuC93EzqKQfXtjApJvHIPcyXI1x0d/qRp+emn9yUC7dc+KR9y/mUw4Y1G3b5MSDLNTSZPJN45B7mS3AxEpN4ymFSQ5PJs/PI/U47wwt4jFOKjMSknnKYxNAE4Mkc4WIkJvWUwxND80f3/ijJ8g9NAB7PrX2go4d//nCu3HbljKG5nN8oAbCcubUPLDKT+K7U6XzgK8AUwQV04QNfAR4juIAFNel3FgCYieACFpQPfAV4MsEFLKhJvbMAwK4ILmBBuZkxwJMJLmDB+cBXgMcTXMCCm9Q7CwA8FZ80Dyy4Sb2zAMBTEVzAgnMzY4DHc0oRAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAMC8nfudc/OqT70q537n3HFPZUkQXADAvNz50J05++qzc8/D9+Tsq8/OnQ/dOe4pLXqCCwCYk003b8qGz23I8Rcd/7jx4y86Phs+tyGX33z5mGa2+AkuAGBOPnbtx7Ltvm0z7tt237acf+35I57R0iG4AIA52bBmwx7tn2SCCwCYk9OPPD2nrTttxn1vWfeWnH7k6SOe0dIhuACAObvrp3fNa5wpggsAmLNV+616dHvNAWse3T5wvwPHMZ0lY8W4JwAALB3vetm7cvRBR+eIlUfkiJVH5MZ7bsyN99yY16x+zbintqgJLgBgzvbZa5+cePiJjz7eGV7smlOKAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM5mDa6q2reqvlFV36mq71XVHw/ja6rq61W1tao+XVVPG8b3GR5vHfYf3ncJAACL21yOcD2c5HWttZcmOSrJSVV1XJL3JflQa+35Se5Octbw/LOS3D2Mf2h4HgDAxJo1uNqU+4eHew9fLcnrknxmGL8gyanD9inD4wz7T6iqWrAZAwAsMXO6hquq9qqqq5NsT3JZkhuT3NNae2R4yi1JDh22D02yLUmG/fcmec5CThoAYCmZU3C11n7eWjsqyWFJjk2ybk//4araWFWbq2rzjh079vTHAQAsWvN6l2Jr7Z4kVyR5RZKVVbVi2HVYkluH7VuTrE6SYf8BSX48w886r7W2vrW2ftWqVbs5fQCAxW8u71JcVVUrh+39krw+yXWZCq83Dk87I8nFw/Ylw+MM+y9vrbWFnDQAwFKyYvan5JAkF1TVXpkKtItaa1+oqu8n+VRVvTfJt5OcPzz//CT/t6q2JrkryZs7zBsAYMmYNbhaa9ckOXqG8R9m6nquJ47/NMm/WZDZAQAsAz5pHgCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQmucbny/cn71kx9BwCWNcE1DvdvT654b/LQXVPf798+7hkBAB0JrlG67gvJR45KPrD28eMfWDs1vuWL45kXANCV4Bqlf/hwcvePZt5394+Sr35otPMBAEZCcI3SS964Z/sBgCVJcI3ScW9Pjt04875j3za1HwBYdgTXqD2wY37jAMCSJ7hGbf9DHts+8AXTxp87+rkAACOxYtwTmDgnvCdZ/fJk1brkoHXJ9i3Jji3JC04a98wAgE4E16jtvW/y4lMfe3zQEF4AwLLllCIAQGeCCwCgM8EFANCZ4AIA6ExwAQB0tjiC6/bvJle+f9yzAADoYnEE1z8/klzx3uT+7eOeCQDAglscwbXTB9YmHzkq2fLFcc8EAGDBLK7gSpK7f5R89UPjngUAwIJZfMGVJC9547hnAADsypXvT963xjXYc7T4guvYtyXHvX3cswAAnsr926euvX7oLtdgz9HiC64Hdox7BgDATK77wtS11h9Y+/hx12DPanEE14p9H9ve/7njmwcA8NT+4cNT11rPxDXYu7Ri3BNIkhx0ZPJbn0h2bElecNK4ZwMAzOQlb0xu+eau9zOjxRFcSXLQuqkvAGBxOu7tyV03Jt8478n7XIO9S4vjlCIAsDQ81bXWrsHeJcEFAMzd/oc8tn3gC6aNuwZ7VxbPKUUAYPE74T3J6pcnq4ZLgbZvcQ32HAguAGDu9t43efGpjz12DfacOKUIANCZ4GK03AoCgAkkuBgdt4IAYEIJLvpzKwgAJtyswVVVq6vqiqr6flV9r6reOYw/u6ouq6obhu/PGsarqj5aVVur6pqqOqb3Iljk3AoCgAk3lyNcjyT53dbai5Icl+QdVfWiJO9Osqm1tjbJpuFxkpycZO3wtTHJOQs+a5aW2W714FYQACxzswZXa+221tq3hu37klyX5NAkpyS5YHjaBUl2vkf0lCQfb1O+lmRlVR0SJtdxb0+O3TjzPreCAGACzOtzuKrq8CRHJ/l6koNba7cNu25PcvCwfWiSbdNedsswdluewvXXX5/Xvva185kKS82OLckDDzx5/G8/nvyvb4x+PgAwQnO+aL6qnpnks0ne1Vr7yfR9rbWWpM3nH66qjVW1uao2/+xnP5vPS1mK9nraY9t77zfzOAAsU3M6wlVVe2cqtj7ZWvvcMHxHVR3SWrttOGW48z3+tyZZPe3lhw1jj9NaOy/JeUmyfv369pWvfGX3VsDS8LOfJj/40sy3gth733HPDgDmrKrm/Zq5vEuxkpyf5LrW2p9N23VJkjOG7TOSXDxt/K3DuxWPS3LvtFOPTKqdt4LYefuHg9ZNPRZbAEyAuRzhemWS30zy3aq6ehj7wyR/muSiqjoryU1J3jTsuzTJhiRbkzyY5MwFnTEAwBIza3C11r6a5KmOnZ0ww/Nbknfs4bwAAJYNnzQPo+AekgATTXBBb+4hyaTwhwU8JcEFvbiHJJPEHxawS4ILenEPSSaBPyxgTgQX9OIekkwCf1jAnAgu6MU9JJkE/rCAORFc0NMDO+Y3DkuNPyxgTgQX9LT/IY9tH/iCaePPHf1coBd/WMCs5nQvRWA3nfCeZPXLZ76HJCwXT/zD4s4fDOP+sICdBBf0tPMekjsdtO6x+0nCcuEPC5iV4AJgz/jDAmblGi4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHAB/Vz5/uR9a6a+A0wwwQX0cf/25Ir3Jg/dNfX9/u3jnhHA2AguYGFd94XkI0clH1j7+PEPrJ0a3/LF8cxrlBzZA55AcAEL6x8+nNz9o5n33f2j5KsfGu18Rs2RPWAGggtYWC95457tX6oc2QN2QXABC+u4tyfHbpx537Fvm9q/HE36kT1glwQXsPAe2DG/8eVgUo/sAXMiuICFt/8hj20f+IJp488d/VxGZVKP7AFzsmLcEwCWoRPek6x+ebJqXXLQumT7lmTHluQFJ417Zn1N4pE9pt6N+rX/kxz3W8lr/vO4Z8Mi5QgXsPD23jd58alTsZVMfX/xqVPjy9kkHtmbdN6Vyhw5wgWwUCb1yN4kuu4LyZf/25PfKPGBtcmz1iS/+j+Sdb82nrmxKAkugIWy88jeTgete+woH8vLXN6VKriYxilFAJgv70plngQXAMyXd6UyT4ILAHaHd6UyD4ILAHaHd6UyDy6aB4Dd4V2pzIPgAoDd4V2pzINTigAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgM8EFANCZ4AIA6ExwAQB0JrgAADoTXAAAnQkuAIDOBBcAQGeCCwCgs1mDq6o+VlXbq+raaWPPrqrLquqG4fuzhvGqqo9W1daquqaqjuk5eQCApWAuR7j+OslJTxh7d5JNrbW1STYNj5Pk5CRrh6+NSc5ZmGkCACxdswZXa+3vk9z1hOFTklwwbF+Q5NRp4x9vU76WZGVVHbJQkwUAWIp29xqug1trtw3btyc5eNg+NMm2ac+7ZRgDAJhYe3zRfGutJWnzfV1VbayqzVW1eceOHXs6DQCARWt3g+uOnacKh+/bh/Fbk6ye9rzDhrEnaa2d11pb31pbv2rVqt2cBgDA4re7wXVJkjOG7TOSXDxt/K3DuxWPS3LvtFOPAAATacVsT6iqC5O8NsmBVXVLkvck+dMkF1XVWUluSvKm4emXJtmQZGuSB5Oc2WHOAABLyqzB1Vo77Sl2nTDDc1uSd+zppAAAlhOfNA8A0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0JngAgDoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ12Cq6pOqqrrq2prVb17tud//7af5M833dBjKovWn2+6IUf/9y9b94SwbuueBNZt3Ty1BQ+uqtoryf9OcnKSFyU5rapetKvX/PyfWz542Q+y476HF3o6i9KO+x7OBy/7Qe5+8GfWPQGs27ongXVbN7tWrbWF/YFVr0jyR621Xx0e/0GStNb+51O9Zp9D1rZDzvhwkuQXn/P0/NcNR+bEFz93Qee1GPzd927Pn1x6XW768YNP2mfd1r1cWLd172Td1r1cVdVVrbX183lNj1OKhybZNu3xLcPYnNz04wdzzpU3LvikFoO/uPLGGX9JE+tejqz7yax7+bHuJ7NuZjK2i+aramNVba6qzT9/8N7H7XvDS39hTLPqa7Z1WffyYt27t3+psu7d279UWffu7Z9kPYLr1iSrpz0+bBh7nNbaea219a219Xs9/YBHx//dLx+eM1+5psO0xu/MV67JGa/4xRn3WffyY91PZt3Lj3U/mXUzkx7B9c0ka6tqTVU9Lcmbk1wy1xffef/yvvDuzgf+aeZx616WrPsJ49a9LFn3E8atmxkseHC11h5J8h+S/F2S65Jc1Fr73q5es8+Kx6Zx0P77LvSUFpWDp63viFXPeHTbupcn67buxLqXK+uerHXvqQV/l+LuWL9+fbvwi1fkhu3353XrDsq+e+817il189Of/TyXb9metQc9M2sP3j833HGfdVv3smPd1m3d1r2c7c67FBdNcG3evHnc0wAAmNVi+VgIAACmWRRHuKrqviTXj3seY3BgkjvHPYkxsO7JYt2Txbony6Su+4Wttf3n84IVvWYyT9fP99DcclBVm617clj3ZLHuyWLdk6Wq5n0dlFOKAACdCS4AgM4WS3CdN+4JjIl1TxbrnizWPVmse7LMe92L4qJ5AIDlbLEc4QIAWLbGGlxV9bGq2l5V145zHqNWVaur6oqq+n5Vfa+q3jnuOY1CVe1bVd+oqu8M6/7jcc9pVKpqr6r6dlV9YdxzGaWq+seq+m5VXb077+pZqqpqZVV9pqq2VNV1VfWKcc+pt6p64fDfeefXT6rqXeOe1yhU1X8a/jft2qq6sKom4h43VfXOYc3fW87/rWdqlap6dlVdVlU3DN+fNdvPGfcRrr9OctKY5zAOjyT53dbai5Icl+QdVfWiMc9pFB5O8rrW2kuTHJXkpKo6bsxzGpV3ZureopPo+NbaURP21vGPJPlSa21dkpdmAv7bt9auH/47H5XkZUkeTPL5MU+ru6o6NMl/TLK+tfaSJHslefN4Z9VfVb0kyb9Pcmymfsd/vaqeP95ZdfPXeXKrvDvJptba2iSbhse7NNbgaq39fZK7xjmHcWit3dZa+9awfV+m/sf40PHOqr825f7h4d7D17K/iLCqDkvya0n+ctxzob+qOiDJq5OcnySttX9qrd0z3lmN3AlJbmyt3TTuiYzIiiT7VdWKJE9P8v/GPJ9RODLJ11trD7bWHklyZZJ/PeY5dfEUrXJKkguG7QuSnDrbzxn3Ea6JV1WHJzk6ydfHO5PRGE6tXZ1ke5LLWmuTsO4PJ/n9JP887omMQUvy5aq6qqo2jnsyI7ImyY4kfzWcRv7LqnrGuCc1Ym9OcuG4JzEKrbVbk6yOc9gAAAKYSURBVHwgyc1Jbktyb2vty+Od1Uhcm+RVVfWcqnp6kg1JVo95TqN0cGvttmH79iQHz/YCwTVGVfXMJJ9N8q7W2k/GPZ9RaK39fDjlcFiSY4fD0stWVf16ku2ttavGPZcx+ZXW2jFJTs7UqfNXj3tCI7AiyTFJzmmtHZ3kgczhdMNyUVVPS/KGJH877rmMwnDtzimZCu1fSPKMqvqN8c6qv9badUnel+TLSb6U5OokPx/rpMakTX3cw6xnawTXmFTV3pmKrU+21j437vmM2nCK5Yos/2v4XpnkDVX1j0k+leR1VfWJ8U5pdIa//tNa256p63mOHe+MRuKWJLdMO3r7mUwF2KQ4Ocm3Wmt3jHsiI/KvkvyotbajtfazJJ9L8stjntNItNbOb629rLX26iR3J/nBuOc0QndU1SFJMnzfPtsLBNcYVFVl6vqO61prfzbu+YxKVa2qqpXD9n5JXp9ky3hn1Vdr7Q9aa4e11g7P1GmWy1try/6v3ySpqmdU1f47t5OcmKnTEMtaa+32JNuq6oXD0AlJvj/GKY3aaZmQ04mDm5McV1VPH/63/YRMwJskkqSqDhq+Py9T12/9zXhnNFKXJDlj2D4jycWzvWCsN6+uqguTvDbJgVV1S5L3tNbOH+ecRuSVSX4zyXeH65mS5A9ba5eOcU6jcEiSC6pqr0zF/kWttYn6mIQJc3CSz0/9f1BWJPmb1tqXxjulkfntJJ8cTq/9MMmZY57PSAxh/fokbxv3XEaltfb1qvpMkm9l6h3o387kfPr6Z6vqOUl+luQdy/XNITO1SpI/TXJRVZ2V5KYkb5r15/ikeQCAvpxSBADoTHABAHQmuAAAOhNcAACdCS4AgM4EFwBAZ4ILAKAzwQUA0Nn/BzjFX1dQptksAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For our three-point TabularModel, we will take data points from lab meaurements at baseline and two other given time points. Example</p>
<ol>
<li>Baseline datapoint</li>
<li>datapoint closes to 200 days from baseline </li>
<li>datapoint closes to 400 days from baseline</li>
</ol>
<p>The second and third timepoint can be a hyperparameter.</p>
<p>In setting up our problem as above, one of the potential issue we would face is the same data point being used for both timepoint1 and timepoint2.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TabularModel(
  (embeds): ModuleList(
    (0): Embedding(6, 4)
    (1): Embedding(3, 3)
  )
  (emb_drop): Dropout(p=0.0, inplace=False)
  (bn_cont): BatchNorm1d(19, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layers): Sequential(
    (0): LinBnDrop(
      (0): Linear(in_features=26, out_features=100, bias=False)
      (1): ReLU(inplace=True)
      (2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): LinBnDrop(
      (0): Linear(in_features=100, out_features=50, bias=False)
      (1): ReLU(inplace=True)
      (2): BatchNorm1d(50, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): LinBnDrop(
      (0): Linear(in_features=50, out_features=2, bias=True)
    )
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above model is what we will use. The categorical features are put through embedding layer (EL). The outputs from EL are but through  a dropout layer and a batchnorm layer before concatenating them with the continuous features. The concatenated outputs are then put through two linear layers of size 100 and 50 respectively. The linear layers are followed by a non-linear layer and a batchnorm layer. The outputs are then put through a final linear layer with 2 outputs.</p>
<p>Loss function of Choice : CrossEntropy</p>
<p>Optimizer: Adam</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Our continuous columns are
[&#39;ldl_200&#39;, &#39;creatinine_200&#39;, &#39;glucose_200&#39;, &#39;sbp_200&#39;, &#39;dbp_200&#39;, &#39;hgb_200&#39;, &#39;ldl_400&#39;, &#39;creatinine_400&#39;, &#39;glucose_400&#39;, &#39;sbp_400&#39;, &#39;dbp_400&#39;, &#39;hgb_400&#39;, &#39;ldl&#39;, &#39;creatinine&#39;, &#39;glucose&#39;, &#39;sbp&#39;, &#39;dbp&#39;, &#39;hgb&#39;, &#39;age&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Our categorical columns are
[&#39;race&#39;, &#39;gender&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">!=</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">==</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                            <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                            <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> 
                                                   <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;tab_3pt_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                        <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                        <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tab_3pt_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">,</span> <span class="n">with_decoded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
  
<span class="n">y_true</span> <span class="o">=</span> <span class="n">test_dl</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fastai/learner.py:56: UserWarning: Saved filed doesn&#39;t contain an optimizer state.
  elif with_opt: warn(&#34;Saved filed doesn&#39;t contain an optimizer state.&#34;)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fastai/learner.py:56: UserWarning: Saved filed doesn&#39;t contain an optimizer state.
  elif with_opt: warn(&#34;Saved filed doesn&#39;t contain an optimizer state.&#34;)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fastai/learner.py:56: UserWarning: Saved filed doesn&#39;t contain an optimizer state.
  elif with_opt: warn(&#34;Saved filed doesn&#39;t contain an optimizer state.&#34;)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fastai/learner.py:56: UserWarning: Saved filed doesn&#39;t contain an optimizer state.
  elif with_opt: warn(&#34;Saved filed doesn&#39;t contain an optimizer state.&#34;)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;5-fold accuracy score: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5-fold accuracy score: 0.65
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7efbfe735790&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we will weighted loss to account for class imbalance</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                            <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                            <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> 
                                                   <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;tab_3pt_wl_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)])</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span> <span class="o">=</span> <span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.67</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">]))</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                        <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                        <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tab_3pt_wl_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">,</span> <span class="n">with_decoded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
  
<span class="n">y_true</span> <span class="o">=</span> <span class="n">test_dl</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;5-fold accuracy score: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5-fold accuracy score: 0.60
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7efbfe72f890&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="6_point-Model">6_point Model<a class="anchor-link" href="#6_point-Model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(-10.0, 750.0)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In our 6-point model, we will take data from 6 datapoints including the baseline.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/train_df_5f.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">,</span> <span class="n">cont_names</span> <span class="o">=</span> <span class="n">prepare_df_ntimepoint</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">])</span>
<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
<span class="n">y_names</span> <span class="o">=</span> <span class="s1">&#39;Stage_Progress&#39;</span>
<span class="n">y_block</span> <span class="o">=</span> <span class="n">CategoryBlock</span><span class="p">()</span>
<span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">!=</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">==</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                            <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                            <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> 
                                                   <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;tab_6pt_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                        <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                        <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tab_6pt_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">,</span> <span class="n">with_decoded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
  
<span class="n">y_true</span> <span class="o">=</span> <span class="n">test_dl</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;5-fold accuracy score: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5-fold accuracy score: 0.73
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7efbf5be2dd0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="First_N_Points-Model">First_N_Points Model<a class="anchor-link" href="#First_N_Points-Model"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we will build a model which takes the first n-points from baseline to use in our classification task</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">!=</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="o">~</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">281</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">7</span><span class="p">])]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">==</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#cat_names.remove(&#39;creatinine_2_na&#39;)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>

    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                            <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                            <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> 
                                                   <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;tab_fnpt_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="o">~</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">299</span><span class="p">,</span><span class="mi">67</span><span class="p">,</span><span class="mi">255</span><span class="p">])]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                        <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                        <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tab_fnpt_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">pred</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">)</span>
    <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
  
<span class="n">y_true</span> <span class="o">=</span> <span class="n">test_dl</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;5-fold accuracy score: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5-fold accuracy score: 0.74
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7efbf5b0efd0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Does-including-medication-data-help?">Does including medication data help?<a class="anchor-link" href="#Does-including-medication-data-help?"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">meds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/dataScienceTask/T_meds.csv&#39;</span><span class="p">)</span>
<span class="n">meds</span> <span class="o">=</span> <span class="n">meds</span><span class="p">[</span><span class="n">meds</span><span class="p">[</span><span class="s1">&#39;end_day&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">650</span><span class="p">]</span>
<span class="n">meddf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">med2como</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">meddf</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">300</span><span class="p">):</span>
    <span class="n">pat</span> <span class="o">=</span> <span class="n">meds</span><span class="p">[</span><span class="n">meds</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span>
    <span class="n">med</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">med2como</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">medstatus</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">:</span><span class="mi">0</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">pat</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()}</span>

    <span class="k">for</span> <span class="n">drug</span> <span class="ow">in</span> <span class="n">pat</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="n">pat</span><span class="p">[</span><span class="n">pat</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">drug</span><span class="p">][</span><span class="s1">&#39;daily_dosage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        
        <span class="n">inidose</span> <span class="o">=</span> <span class="n">doses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">change</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="n">doses</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">dose</span><span class="o">&gt;</span><span class="n">inidose</span><span class="p">:</span>
                <span class="n">change</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="n">meddf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">drug</span><span class="p">]</span> <span class="o">=</span> <span class="n">change</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">meddf</span> <span class="o">=</span> <span class="n">meddf</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">med_cat_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">meddf</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">meddf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>atorvastatin</th>
      <th>losartan</th>
      <th>metformin</th>
      <th>rosuvastatin</th>
      <th>pravastatin</th>
      <th>carvedilol</th>
      <th>valsartan</th>
      <th>metoprolol</th>
      <th>simvastatin</th>
      <th>bisoprolol</th>
      <th>atenolol</th>
      <th>lovastatin</th>
      <th>olmesartan</th>
      <th>irbesartan</th>
      <th>canagliflozin</th>
      <th>dapagliflozin</th>
      <th>telmisartan</th>
      <th>labetalol</th>
      <th>nebivolol</th>
      <th>pitavastatin</th>
      <th>propranolol</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">!=</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">==</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                            <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                            <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> 
                                                   <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;tab_3pt_meds_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>

<span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">dls</span><span class="p">,</span> <span class="n">tabdf</span> <span class="o">=</span> <span class="n">get_tabpandas_dls</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">tabdf</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> 
                        <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                        <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SaveModelCallback</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)])</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tab_3pt_meds_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">pred</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">)</span>
    <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">test_dl</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5-fold accuracy score: 0.67
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7efbf5b81990&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

